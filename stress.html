<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>äº²çˆ±çš„å°ç‹®å­ï¼Œæ¬¢è¿å›å®¶</title>
    <!-- ä½¿ç”¨å›½å†…æé€Ÿé™æ€èµ„æºé•œåƒ -->
    <link rel="stylesheet" href="https://cdn.staticfile.org/tailwindcss/2.2.19/tailwind.min.css">
    <script src="https://cdn.staticfile.org/lucide/0.263.0/lucide.min.js"></script>
    <style>
        /* æ ¸å¿ƒå¸ƒå±€ä¿åº•æ ·å¼ */
        html, body {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            background-color: #eff6ff;
            font-family: -apple-system, system-ui, "Microsoft YaHei", sans-serif;
            overflow: hidden;
            -webkit-tap-highlight-color: transparent;
            user-select: none;
        }
        #app {
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            opacity: 0;
            transition: opacity 0.5s ease-in;
        }

        /* åŠ¨ç”»å®šä¹‰ */
        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(-1deg); }
            50% { transform: translateY(-15px) rotate(1deg); }
        }
        .animate-float { animation: float 4s ease-in-out infinite; }

        /* åˆ‡å¼€æ•ˆæœï¼šé—ªå…‰è½¨è¿¹ */
        .slash-effect {
            position: absolute;
            height: 4px;
            background: white;
            box-shadow: 0 0 10px white;
            transform-origin: left center;
            pointer-events: none;
            z-index: 100;
            animation: slash-fade 0.3s forwards;
        }
        @keyframes slash-fade {
            0% { width: 0; opacity: 1; }
            100% { width: 150px; opacity: 0; }
        }

        /* æ€ªç‰©è¢«åˆ‡å¼€æ—¶çš„åŠ¨ç”» */
        .monster-cut {
            animation: cut-apart 0.4s ease-out forwards;
        }
        @keyframes cut-apart {
            0% { transform: scale(1); opacity: 1; }
            100% { transform: scale(1.5) rotate(10deg); opacity: 0; filter: contrast(200%) brightness(200%); }
        }

        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }

        /* å‹åŠ›æºç‰¹æ•ˆï¼šé‚£ç§è¢«äººå”¾å¼ƒçš„â€œè´Ÿèƒ½é‡â€æ°”åœº */
        .monster-vibe {
            box-shadow: 0 0 20px rgba(0,0,0,0.3);
            border: 2px solid rgba(255,255,255,0.1);
            background: radial-gradient(circle at 30% 30%, rgba(255,255,255,0.15), transparent);
        }
    </style>
</head>
<body>
    <div id="app">
        <div style="display:flex; align-items:center; justify-content:center; height:100vh;">
            <p style="color:#60a5fa;">æ­£åœ¨è¿›å…¥ä½ çš„ä¸“å±è§£å‹ç©ºé—´...</p>
        </div>
    </div>

    <script>
        const state = {
            mode: 'welcome',
            score: 0,
            monsters: [],
            lastSlash: { x: 0, y: 0 }
        };

        const MONSTER_TYPES = [
            { id: 'family', text: "æ— ç†çš„å®¶å±", emoji: "ğŸ‘¹", color: "from-red-600 to-red-900", hp: 1 },
            { id: 'paperwork', text: "è¯¥æ­»çš„ç—…å†", emoji: "ğŸ“", color: "from-blue-700 to-indigo-900", hp: 1 },
            { id: 'night', text: "è®¨åŒçš„å¤œç­", emoji: "ğŸ¦‡", color: "from-purple-800 to-black", hp: 1 },
            { id: 'hungry', text: "ä¸çˆ½çš„åŒäº‹", emoji: "ğŸ§Ÿ", color: "from-green-700 to-green-950", hp: 1 },
            { id: 'leader', text: "é¢†å¯¼çš„åºŸè¯", emoji: "ğŸ¦†", color: "from-yellow-600 to-yellow-900", hp: 1 }
        ];

        function render() {
            const app = document.getElementById('app');
            let content = '';
            
            if (state.mode === 'welcome') {
                content = `
                    <div class="flex flex-col items-center justify-center h-screen p-6 text-center">
                        <div class="bg-white p-8 rounded-3xl shadow-2xl max-w-sm w-full border-t-8 border-blue-500">
                            <i data-lucide="heart-pulse" class="w-16 h-16 text-blue-500 mx-auto mb-4"></i>
                            <h1 class="text-2xl font-bold mb-2 text-gray-800">äº²çˆ±çš„å°ç‹®å­ï¼Œè¾›è‹¦äº†</h1>
                            <p class="text-gray-500 mb-6 italic">â€œè¿™é‡Œæ²¡æœ‰ç—…äººï¼Œæ²¡æœ‰è€ƒæ ¸ï¼Œåªæœ‰æˆ‘ã€‚â€</p>
                            <button onclick="changeMode('vent')" class="w-full bg-blue-500 text-white py-4 rounded-full text-lg font-bold shadow-lg active:scale-95 transition-transform">
                                å¼€å¯â€œåˆ‡ç¢çƒ¦æ¼â€æ¨¡å¼
                            </button>
                        </div>
                    </div>
                `;
            } else if (state.mode === 'vent') {
                content = `
                    <div class="h-screen bg-black text-white flex flex-col relative overflow-hidden" 
                         onmousemove="handleSlash(event)" ontouchmove="handleSlash(event)">
                        <div class="flex justify-between items-center p-4 bg-gray-900 border-b border-gray-800 z-50">
                            <div class="font-bold text-yellow-500 flex items-center tracking-tighter">
                                <i data-lucide="sword" class="w-4 h-4 mr-2"></i> æ–©æ–­çƒ¦æ¼: ${state.score}
                            </div>
                            <button onclick="changeMode('calm')" class="bg-green-600 px-4 py-1.5 rounded-full text-xs font-bold shadow-md">æ¶ˆæ°”äº† &rarr;</button>
                        </div>
                        
                        <div id="arena" class="flex-1 relative overflow-hidden">
                            ${state.monsters.length === 0 ? '<div class="absolute inset-0 flex flex-col items-center justify-center text-gray-700 text-center px-10 italic"><p class="text-3xl mb-2">ğŸ‘‹</p><p>æ»‘åŠ¨å±å¹•åˆ‡ç¢é‚£äº›è®¨åŒçš„ä¸œè¥¿ï¼</p></div>' : ''}
                            ${state.monsters.map(m => `
                                <div id="m-${m.instanceId}" class="absolute animate-float transition-all duration-300" 
                                     style="left: ${m.x}%; top: ${m.y}%;">
                                    <div class="w-24 h-24 rounded-full bg-gradient-to-br ${m.color} monster-vibe flex items-center justify-center text-4xl relative">
                                        <!-- æ„¤æ€’ç¬¦å·è£…é¥° -->
                                        <div class="absolute -top-2 -right-2 text-red-500 text-xl font-black">ğŸ’¢</div>
                                        <div class="absolute -bottom-1 -left-1 text-gray-400 text-lg">â˜ ï¸</div>
                                        
                                        <span class="z-10">${m.emoji}</span>
                                        
                                        <!-- è¢«äººå”¾å¼ƒçš„åå­—æ ‡ç­¾ -->
                                        <div class="absolute -bottom-8 left-1/2 -translate-x-1/2 bg-red-900/80 text-white text-[10px] px-2 py-0.5 rounded border border-red-500/30 whitespace-nowrap shadow-lg">
                                            æ»šè¿œç‚¹: ${m.text}
                                        </div>
                                    </div>
                                </div>
                            `).join('')}
                        </div>

                        <div class="bg-gray-950 p-4 pb-10 z-50">
                            <div class="text-[9px] text-gray-500 mb-2 uppercase tracking-[0.2em] font-black">å¬å”¤é‚£äº›ä»¤äººåŒæ¶çš„...</div>
                            <div class="flex gap-3 overflow-x-auto no-scrollbar pb-2">
                                ${MONSTER_TYPES.map(t => `
                                    <button onclick="spawnMonster('${t.id}')" class="flex-shrink-0 w-20 h-24 bg-gray-900 rounded-2xl flex flex-col items-center justify-center border-2 border-gray-800 active:border-red-600 active:scale-95 transition-all">
                                        <span class="text-3xl filter grayscale hover:grayscale-0 transition-all">${t.emoji}</span>
                                        <span class="text-[10px] mt-2 font-bold text-gray-400">${t.text}</span>
                                    </button>
                                `).join('')}
                            </div>
                        </div>
                    </div>
                `;
            } else if (state.mode === 'calm') {
                content = `
                    <div class="h-screen bg-green-50 flex flex-col items-center justify-center p-6 text-center">
                        <h2 class="text-2xl font-bold text-green-800 mb-8 tracking-tight">å¹³å¤å‘¼å¸ï¼Œå®ƒä»¬éƒ½æ¶ˆå¤±äº†</h2>
                        <div id="breath-circle" class="w-48 h-48 bg-green-200 rounded-full flex items-center justify-center shadow-inner transition-all duration-[4000ms] ease-in-out border-4 border-green-100">
                            <span id="breath-text" class="text-xl font-bold text-green-800">å¸æ°”...</span>
                        </div>
                        <p class="mt-12 text-green-700 font-medium">åæƒ…ç»ªå·²è¢«æ–©æ–­ã€‚ç°åœ¨ï¼Œåªæœ‰å¹³é™çš„ä½ ã€‚</p>
                        <button onclick="changeMode('love')" class="mt-12 bg-white text-green-600 px-8 py-3 rounded-full font-bold shadow-md border border-green-200 active:scale-95">
                            ç»§ç»­ &rarr;
                        </button>
                    </div>
                `;
                startBreathing();
            } else if (state.mode === 'love') {
                content = `
                    <div class="h-screen bg-pink-50 flex flex-col items-center justify-center p-6">
                        <div class="bg-white p-8 rounded-[2.5rem] shadow-2xl max-w-sm w-full text-center relative border border-pink-100">
                            <div class="absolute -top-10 left-1/2 transform -translate-x-1/2 bg-red-500 text-white p-4 rounded-full shadow-lg">
                                <i data-lucide="heart" class="w-8 h-8 fill-current"></i>
                            </div>
                            <h2 class="text-2xl font-bold mb-6 mt-4 text-gray-800">æœ€æ£’çš„å°ç‹®å­ï¼Œè¾›è‹¦äº†</h2>
                            <div class="text-left space-y-4 mb-8">
                                <div class="bg-pink-50 p-4 rounded-2xl border-l-4 border-pink-400">
                                    <p class="text-sm text-gray-700 leading-relaxed font-medium">æ‰€æœ‰çš„çƒ¦æ¼éƒ½è¢«ä½ åˆ‡ç¢äº†ï¼ç°åœ¨ï¼Œè¯·æ¥å—è¿™ä¸ªç‰¹åˆ«çš„ç¤¼ç‰©ã€‚</p>
                                </div>
                            </div>
                            <div class="space-y-3">
                                <button onclick="handleClaim()" class="w-full bg-gradient-to-r from-red-500 to-pink-500 text-white py-4 rounded-2xl font-bold shadow-lg shadow-pink-200 active:scale-95 transition-all">
                                    é¢†å–ã€Œè¶…å¤§å·æ‹¥æŠ±ã€
                                </button>
                                <button onclick="changeMode('welcome')" class="w-full bg-gray-100 text-gray-500 py-3 rounded-2xl font-bold hover:bg-gray-200 active:scale-95 transition-all text-sm">
                                    å†æ¥ä¸€æ¬¡
                                </button>
                            </div>
                        </div>
                    </div>
                `;
            }

            app.innerHTML = content;
            app.style.opacity = 1;
            if (typeof lucide !== 'undefined') lucide.createIcons();
        }

        function handleSlash(e) {
            if (state.mode !== 'vent') return;
            
            const clientX = e.clientX || (e.touches && e.touches[0].clientX);
            const clientY = e.clientY || (e.touches && e.touches[0].clientY);
            
            if (!clientX || !clientY) return;

            // åˆ›å»ºè§†è§‰ä¸Šçš„åˆ’ç—•æ•ˆæœ
            createSlashGraphic(clientX, clientY);

            // ç¢°æ’æ£€æµ‹ï¼šæ£€æŸ¥æ˜¯å¦â€œåˆ‡åˆ°â€äº†æ€ªç‰©
            state.monsters.forEach(m => {
                const el = document.getElementById(`m-${m.instanceId}`);
                if (!el) return;
                const rect = el.getBoundingClientRect();
                const monsterCenterX = rect.left + rect.width / 2;
                const monsterCenterY = rect.top + rect.height / 2;
                
                const dist = Math.sqrt(Math.pow(clientX - monsterCenterX, 2) + Math.pow(clientY - monsterCenterY, 2));
                
                if (dist < 60) { // åˆ‡ä¸­èŒƒå›´
                    hitMonster(m.instanceId);
                }
            });
        }

        function createSlashGraphic(x, y) {
            const arena = document.getElementById('arena');
            if (!arena) return;
            
            const slash = document.createElement('div');
            slash.className = 'slash-effect';
            slash.style.left = x + 'px';
            slash.style.top = y + 'px';
            slash.style.transform = `rotate(${Math.random() * 360}deg)`;
            arena.appendChild(slash);
            setTimeout(() => slash.remove(), 300);
        }

        function changeMode(m) {
            if (breathTimer) clearInterval(breathTimer);
            const app = document.getElementById('app');
            app.style.opacity = 0;
            setTimeout(() => {
                state.mode = m;
                if(m === 'welcome') {
                    state.score = 0;
                    state.monsters = [];
                }
                render();
            }, 300);
        }

        function spawnMonster(typeId) {
            const type = MONSTER_TYPES.find(t => t.id === typeId);
            const monster = {
                ...type,
                instanceId: Date.now() + Math.random(),
                x: 15 + Math.random() * 60,
                y: 15 + Math.random() * 50
            };
            state.monsters.push(monster);
            render();
            if(window.navigator.vibrate) window.navigator.vibrate(15);
        }

        function hitMonster(id) {
            const mIndex = state.monsters.findIndex(m => m.instanceId === id);
            if (mIndex !== -1) {
                const el = document.getElementById(`m-${id}`);
                if (el && !el.classList.contains('monster-cut')) {
                    el.classList.add('monster-cut');
                    state.score += 10;
                    if(window.navigator.vibrate) window.navigator.vibrate(40);
                    
                    setTimeout(() => {
                        state.monsters = state.monsters.filter(item => item.instanceId !== id);
                        render();
                    }, 400);
                }
            }
        }

        let breathTimer;
        function startBreathing() {
            let step = 0;
            const update = () => {
                const circle = document.getElementById('breath-circle');
                const text = document.getElementById('breath-text');
                if(!circle || !text) return;
                if (step % 2 === 0) {
                    circle.style.transform = 'scale(1.4)';
                    text.innerText = 'å¸æ°”...';
                } else {
                    circle.style.transform = 'scale(1)';
                    text.innerText = 'å‘¼æ°”...';
                }
                step++;
            };
            setTimeout(update, 100);
            breathTimer = setInterval(update, 4000);
        }

        function handleClaim() {
            const overlay = document.createElement('div');
            overlay.className = "fixed inset-0 bg-black/80 backdrop-blur-md flex items-center justify-center z-[100] p-6";
            overlay.innerHTML = `
                <div class="bg-white rounded-3xl p-8 text-center shadow-2xl max-w-xs scale-in">
                    <div class="text-6xl mb-4 animate-bounce">ğŸ§§</div>
                    <h3 class="text-xl font-bold mb-2 text-gray-800">å…‘æ¢æˆåŠŸï¼</h3>
                    <p class="text-gray-500 text-sm mb-6">æ­¤åˆ¸é•¿æœŸæœ‰æ•ˆï¼šå‡­æ­¤é¡µå¯éšæ—¶æŸæŸäººç´¢è¦è¶…çº§å¤§çš„æ‹¥æŠ±ä¸€ä¸ªï¼</p>
                    <button onclick="this.parentElement.parentElement.remove()" class="bg-red-500 text-white px-10 py-3 rounded-full font-bold shadow-lg">å¥½å“’</button>
                </div>
            `;
            document.body.appendChild(overlay);
        }

        window.onload = render;
    </script>
</body>
</html>
