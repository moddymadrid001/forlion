<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>äº²çˆ±çš„å°ç‹®å­ï¼Œæ¬¢è¿å›å®¶</title>
    <!-- ä½¿ç”¨å›½å†…æé€Ÿé™æ€èµ„æºé•œåƒ -->
    <link rel="stylesheet" href="https://cdn.staticfile.org/tailwindcss/2.2.19/tailwind.min.css">
    <script src="https://cdn.staticfile.org/lucide/0.263.0/lucide.min.js"></script>
    <style>
        /* æ ¸å¿ƒå¸ƒå±€ä¿åº•æ ·å¼ï¼šé˜²æ­¢ç™½å± */
        html, body {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            background-color: #eff6ff; /* æµ…è“è‰²èƒŒæ™¯ */
            font-family: -apple-system, system-ui, "Microsoft YaHei", sans-serif;
            overflow: hidden;
            -webkit-tap-highlight-color: transparent;
        }
        #app {
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            opacity: 0;
            transition: opacity 0.5s ease-in;
        }
        /* åŠ¨ç”»å®šä¹‰ */
        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-10px) rotate(2deg); }
        }
        .animate-float { animation: float 3s ease-in-out infinite; }

        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
    </style>
</head>
<body>
    <div id="app">
        <!-- JS å°†åœ¨è¿™é‡Œæ³¨å…¥å†…å®¹ -->
        <div style="display:flex; align-items:center; justify-content:center; height:100vh;">
            <p style="color:#60a5fa;">æ­£åœ¨ä¸ºä½ åŠ è½½ä¸“å±ç©ºé—´...</p>
        </div>
    </div>

    <script>
        // æ¸¸æˆçŠ¶æ€
        const state = {
            mode: 'welcome',
            score: 0,
            monsters: [],
            breathState: 'å¸æ°”'
        };

        const MONSTER_TYPES = [
            { id: 'family', text: "è¯¥æ­»çš„æ— ç†å®¶å±", emoji: "ğŸ‘¹", color: "bg-red-500", hp: 5 },
            { id: 'paperwork', text: "è¯¥æ­»çš„ç—…å†", emoji: "ğŸ“", color: "bg-blue-500", hp: 3 },
            { id: 'night', text: "è¯¥æ­»çš„å¤§å¤œç­", emoji: "ğŸ¦‡", color: "bg-purple-600", hp: 2 },
            { id: 'hungry', text: "è¯¥æ­»çš„é¢†å¯¼åºŸè¯", emoji: "ğŸ§Ÿ", color: "bg-green-500", hp: 1 },
            { id: 'leader', text: "è¯¥æ­»çš„æ²¡å®Œæ²¡äº†", emoji: "ğŸ¦†", color: "bg-yellow-500", hp: 4 }
        ];

        function render() {
            const app = document.getElementById('app');
            let content = '';

            if (state.mode === 'welcome') {
                content = `
                    <div class="flex flex-col items-center justify-center h-screen p-6 text-center">
                        <div class="bg-white p-8 rounded-3xl shadow-xl max-w-sm w-full border-t-8 border-blue-400">
                            <i data-lucide="stethoscope" class="w-16 h-16 text-blue-500 mx-auto mb-4"></i>
                            <h1 class="text-2xl font-bold mb-2 text-gray-800">äº²çˆ±çš„ï¼Œè¾›è‹¦äº†</h1>
                            <p class="text-gray-500 mb-6 italic">â€œè¿™é‡Œæ²¡æœ‰ç—…äººï¼Œæ²¡æœ‰è€ƒæ ¸ï¼Œåªæœ‰æˆ‘ã€‚â€</p>
                            <button onclick="changeMode('vent')" class="w-full bg-blue-500 text-white py-4 rounded-full text-lg font-bold shadow-lg active:scale-95 transition-transform flex items-center justify-center">
                                è¿›å…¥ä¸“å±è§£å‹ç©ºé—´
                            </button>
                        </div>
                    </div>
                `;
            } else if (state.mode === 'vent') {
                content = `
                    <div class="h-screen bg-gray-900 text-white flex flex-col relative overflow-hidden">
                        <div class="flex justify-between items-center p-4 bg-gray-800 border-b border-gray-700 z-50 shadow-md">
                            <div class="font-bold text-yellow-400 flex items-center">
                                <i data-lucide="zap" class="w-4 h-4 mr-1"></i> æˆ˜ç»©: ${state.score}
                            </div>
                            <button onclick="changeMode('calm')" class="bg-green-600 px-4 py-2 rounded-full text-sm font-bold shadow-md">æ¶ˆæ°”äº† &rarr;</button>
                        </div>

                        <div id="arena" class="flex-1 relative">
                            ${state.monsters.length === 0 ? '<div class="absolute inset-0 flex items-center justify-center text-gray-500 text-center px-10 italic">ç‚¹å‡»ä¸‹æ–¹å¬å”¤çƒ¦æ¼ï¼Œç„¶åç‹ ç‹ ç‚¹å‡»å®ƒä»¬ï¼</div>' : ''}
                            ${state.monsters.map(m => `
                                <div onclick="hitMonster(${m.instanceId})" id="m-${m.instanceId}" class="absolute animate-float cursor-pointer" style="left: ${m.x}%; top: ${m.y}%;">
                                    <div class="w-20 h-20 rounded-full ${m.color} flex items-center justify-center text-4xl shadow-2xl border-4 border-white/20 relative active:scale-90 transition-transform">
                                        <div class="absolute -top-4 left-0 w-full bg-gray-700 h-2 rounded-full overflow-hidden border border-white/10">
                                            <div class="h-full bg-green-400" style="width: ${(m.hp/m.maxHp)*100}%"></div>
                                        </div>
                                        ${m.emoji}
                                        <div class="absolute -bottom-6 text-[10px] bg-black/50 px-2 py-0.5 rounded-full whitespace-nowrap font-bold">${m.text}</div>
                                    </div>
                                </div>
                            `).join('')}
                        </div>

                        <div class="bg-gray-800 p-4 pb-10 z-50 shadow-2xl">
                            <div class="text-[10px] text-gray-400 mb-2 uppercase tracking-widest font-bold">å¬å”¤çƒ¦æ¼æº</div>
                            <div class="flex gap-3 overflow-x-auto no-scrollbar pb-2">
                                ${MONSTER_TYPES.map(t => `
                                    <button onclick="spawnMonster('${t.id}')" class="flex-shrink-0 w-20 h-24 bg-gray-700 rounded-2xl flex flex-col items-center justify-center border-2 border-gray-600 active:border-blue-400 active:bg-gray-600 shadow-lg transition-colors">
                                        <span class="text-3xl">${t.emoji}</span>
                                        <span class="text-xs mt-1 font-bold text-gray-200">${t.text}</span>
                                    </button>
                                `).join('')}
                            </div>
                        </div>
                    </div>
                `;
            } else if (state.mode === 'calm') {
                content = `
                    <div class="h-screen bg-green-50 flex flex-col items-center justify-center p-6 text-center">
                        <h2 class="text-2xl font-bold text-green-800 mb-8">æ·±å‘¼å¸... å¹³å¤å¿ƒæƒ…</h2>
                        <div id="breath-circle" class="w-48 h-48 bg-green-200 rounded-full flex items-center justify-center shadow-inner transition-all duration-[4000ms] ease-in-out border-4 border-green-100">
                            <span id="breath-text" class="text-xl font-bold text-green-800">å¸æ°”</span>
                        </div>
                        <div class="mt-12 space-y-2 text-green-700 font-medium px-4">
                            <p>åˆšæ‰çš„å‹åŠ›å·²ç»éšç€æ€ªå…½æ¶ˆæ•£äº†ã€‚</p>
                            <p>ç°åœ¨ï¼Œè®©ä¸–ç•Œå®‰é™å››ç§’é’Ÿã€‚</p>
                        </div>
                        <button onclick="changeMode('love')" class="mt-12 bg-white text-green-600 px-8 py-3 rounded-full font-bold shadow-md border border-green-200 active:scale-95 transition-transform">
                            å……èƒ½å®Œæˆ
                        </button>
                    </div>
                `;
                startBreathing();
            } else if (state.mode === 'love') {
                content = `
                    <div class="h-screen bg-pink-50 flex flex-col items-center justify-center p-6">
                        <div class="bg-white p-8 rounded-[2rem] shadow-2xl max-w-sm w-full text-center relative border border-pink-100">
                            <div class="absolute -top-10 left-1/2 transform -translate-x-1/2 bg-red-500 text-white p-4 rounded-full shadow-lg">
                                <i data-lucide="heart" class="w-8 h-8 fill-current"></i>
                            </div>
                            <h2 class="text-2xl font-bold mb-6 mt-4 text-gray-800 font-sans">è¶…çº§åŒ»ç”Ÿï¼Œè¾›è‹¦äº†ï¼</h2>
                            <div class="text-left space-y-4 mb-8">
                                <div class="bg-pink-50 p-4 rounded-2xl border-l-4 border-pink-400 shadow-sm">
                                    <p class="text-xs text-pink-600 font-bold mb-1 uppercase tracking-wider">To My Hero:</p>
                                    <p class="text-sm text-gray-700 leading-relaxed font-medium">ä½ å®ˆæŠ¤ç—…äººï¼Œæˆ‘å®ˆæŠ¤ä½ ã€‚ä¸ç®¡ä»Šå¤©å¤šç´¯ï¼Œå›åˆ°å®¶æˆ‘å°±æ˜¯ä½ çš„ä¸“å±å……ç”µå®ã€‚</p>
                                </div>
                                <div class="bg-blue-50 p-4 rounded-2xl border-l-4 border-blue-400 shadow-sm">
                                    <p class="text-xs text-blue-600 font-bold mb-1 uppercase tracking-wider">Today's Menu:</p>
                                    <p class="text-sm text-gray-700 leading-relaxed font-medium">å®¶åŠ¡å½’æˆ‘ï¼Œæ€€æŠ±å½’ä½ ã€‚æ™šé¥­å·²ç»å‡†å¤‡å¥½äº†ï¼Œå°±ç­‰ä½ å›å®¶ã€‚</p>
                                </div>
                            </div>
                            <button onclick="handleClaim()" class="w-full bg-gradient-to-r from-red-500 to-pink-500 text-white py-4 rounded-2xl font-bold shadow-lg shadow-pink-200 active:scale-95 transition-all">
                                é¢†å–ã€Œè¶…å¤§å·æ‹¥æŠ±ã€
                            </button>
                        </div>
                    </div>
                `;
            }

            app.innerHTML = content;
            app.style.opacity = 1;

            // ç¡®ä¿å›¾æ ‡åº“åŠ è½½ååˆå§‹åŒ–å›¾æ ‡
            if (typeof lucide !== 'undefined') {
                lucide.createIcons();
            }
        }

        function changeMode(m) {
            if (breathTimer) clearInterval(breathTimer);
            const app = document.getElementById('app');
            app.style.opacity = 0;
            setTimeout(() => {
                state.mode = m;
                render();
            }, 300);
        }

        function spawnMonster(typeId) {
            const type = MONSTER_TYPES.find(t => t.id === typeId);
            const monster = {
                ...type,
                instanceId: Date.now() + Math.random(),
                maxHp: type.hp,
                x: 10 + Math.random() * 65,
                y: 10 + Math.random() * 55
            };
            state.monsters.push(monster);
            render();
            if(window.navigator.vibrate) window.navigator.vibrate(20);
        }

        function hitMonster(id) {
            const mIndex = state.monsters.findIndex(m => m.instanceId === id);
            if (mIndex !== -1) {
                state.monsters[mIndex].hp -= 1;
                if(window.navigator.vibrate) window.navigator.vibrate(50);

                if (state.monsters[mIndex].hp <= 0) {
                    state.score += 10;
                    state.monsters.splice(mIndex, 1);
                }
                render();
            }
        }

        let breathTimer;
        function startBreathing() {
            let step = 0;
            const update = () => {
                const circle = document.getElementById('breath-circle');
                const text = document.getElementById('breath-text');
                if(!circle || !text) return;

                if (step % 2 === 0) {
                    circle.style.transform = 'scale(1.4)';
                    circle.style.backgroundColor = '#dcfce7';
                    text.innerText = 'å¸æ°”...';
                } else {
                    circle.style.transform = 'scale(1)';
                    circle.style.backgroundColor = '#bbf7d0';
                    text.innerText = 'å‘¼æ°”...';
                }
                step++;
            };
            setTimeout(update, 100);
            breathTimer = setInterval(update, 4000);
        }

        function handleClaim() {
            const overlay = document.createElement('div');
            overlay.className = "fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-[100] p-6";
            overlay.innerHTML = `
                <div class="bg-white rounded-3xl p-8 text-center shadow-2xl max-w-xs animate-float">
                    <div class="text-5xl mb-4">âœ¨</div>
                    <h3 class="text-xl font-bold mb-2">å…‘æ¢æˆåŠŸï¼</h3>
                    <p class="text-gray-500 text-sm mb-6">è¯·æ”¾ä¸‹æ‰‹æœºï¼Œç«‹åˆ»å‘èº«è¾¹çš„ç”·æœ‹å‹ç´¢è¦ä¸€ä¸ªè¶…çº§å¤§çš„æ‹¥æŠ±ï¼</p>
                    <button onclick="this.parentElement.parentElement.remove()" class="bg-gray-900 text-white px-8 py-2 rounded-full font-bold shadow-lg">çŸ¥é“å•¦</button>
                </div>
            `;
            document.body.appendChild(overlay);
        }

        // åˆå§‹åŒ–è¿è¡Œ
        window.onload = render;
    </script>
</body>
</html>
